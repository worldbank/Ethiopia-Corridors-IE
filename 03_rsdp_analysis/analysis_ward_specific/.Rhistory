# Travel time from DHS location to nearest health facility
# Setup ------------------------------------------------------------------------
WALKING_SPEED <- 5 # km/hr
OVERWRITE_FILES <- F
# Load and Prep Data -----------------------------------------------------------
## Roads
roads <- readRDS(file.path(ethie_project_file_path, "Data", "FinalData", "roads", "RoadNetworkPanelData_1996_2016.Rds"))
roads <- spTransform(roads, CRS(UTM_ETH))
## DHS
prep_dhs <- function(df){
df <- df %>%
dplyr::select(DHSID, LATNUM, LONGNUM) %>%
filter(LONGNUM > 0)
coordinates(df) <- ~LONGNUM+LATNUM
crs(df) <- CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0")
df <- spTransform(df, CRS(UTM_ETH))
return(df)
}
dhs_2000 <- read.csv(file.path(project_file_path, "data", "Ethiopia_DHS", "Eth_DHS2000.csv"),
stringsAsFactors = F) %>% prep_dhs()
dhs_2005 <- read.csv(file.path(project_file_path, "data", "Ethiopia_DHS", "Eth_DHS2005.csv"),
stringsAsFactors = F) %>% prep_dhs()
dhs_2011 <- read.csv(file.path(project_file_path, "data", "Ethiopia_DHS", "Eth_DHS2011.csv"),
stringsAsFactors = F) %>% prep_dhs()
dhs_2016 <- read.csv(file.path(project_file_path, "data", "Ethiopia_DHS", "Eth_DHS2016.csv"),
stringsAsFactors = F) %>% prep_dhs()
## Health Facilities
# Travel time from DHS location to nearest health facility
# Setup ------------------------------------------------------------------------
if(Sys.info()[["user"]] == "robmarty") project_file_path <- "~/Dropbox/World Bank/IEs/RoadsHealthShared"
if(Sys.info()[["user"]] == "WB521633") project_file_path <- "C:/Users/wb521633/Dropbox/World Bank/IEs/RoadsHealthShared"
if(Sys.info()[["user"]] == "robmarty") ethie_project_file_path <- "~/Dropbox/World Bank/IEs/Ethiopia IE"
if(Sys.info()[["user"]] == "WB521633") ethie_project_file_path <- "C:/Users/wb521633/Dropbox/World Bank/IEs/Ethiopia IE"
cost_t_path <- file.path(project_file_path, "data", "DHS travel time to facilities", "transition_layers")
UTM_ETH <- '+init=epsg:20138'
WALKING_SPEED <- 5 # km/hr
RESOLUTION_KM <- 0.25
DIRECTIONS = 8
library(dplyr)
library(raster)
library(rgdal)
library(rgeos)
library(velox)
library(gdistance)
library(haven)
library(stringr)
library(purrr)
library(labelled)
# Travel time from DHS location to nearest health facility
# Setup ------------------------------------------------------------------------
WALKING_SPEED <- 5 # km/hr
OVERWRITE_FILES <- F
# Load and Prep Data -----------------------------------------------------------
## Roads
roads <- readRDS(file.path(ethie_project_file_path, "Data", "FinalData", "roads", "RoadNetworkPanelData_1996_2016.Rds"))
roads <- spTransform(roads, CRS(UTM_ETH))
## DHS
prep_dhs <- function(df){
df <- df %>%
dplyr::select(DHSID, LATNUM, LONGNUM) %>%
filter(LONGNUM > 0)
coordinates(df) <- ~LONGNUM+LATNUM
crs(df) <- CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0")
df <- spTransform(df, CRS(UTM_ETH))
return(df)
}
dhs_2000 <- read.csv(file.path(project_file_path, "data", "Ethiopia_DHS", "Eth_DHS2000.csv"),
stringsAsFactors = F) %>% prep_dhs()
dhs_2005 <- read.csv(file.path(project_file_path, "data", "Ethiopia_DHS", "Eth_DHS2005.csv"),
stringsAsFactors = F) %>% prep_dhs()
dhs_2011 <- read.csv(file.path(project_file_path, "data", "Ethiopia_DHS", "Eth_DHS2011.csv"),
stringsAsFactors = F) %>% prep_dhs()
dhs_2016 <- read.csv(file.path(project_file_path, "data", "Ethiopia_DHS", "Eth_DHS2016.csv"),
stringsAsFactors = F) %>% prep_dhs()
## Health Facilities
head(dhs_2016)
dhs_2016$DHSID
dhs_2016$DHSID %>% sort()
dhs_2016 <- read.csv(file.path(project_file_path, "data", "Ethiopia_DHS", "Eth_DHS2016.csv"),
stringsAsFactors = F)
View(dhs_2016)
